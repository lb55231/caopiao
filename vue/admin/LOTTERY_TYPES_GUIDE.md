# 彩种管理功能说明

## 功能概述
彩种管理模块用于管理系统中的所有彩票种类，包括添加、编辑、删除彩种，以及设置彩种的开启/关闭状态和维护状态。

## 功能特性

### 1. 彩种分类
系统支持以下彩种分类：
- **时时彩** (ssc)
- **快三** (k3) 
- **11选5** (x5)
- **快乐彩** (keno)
- **PK10** (pk10)
- **低频彩** (dpc)
- **六合彩** (lhc)

### 2. 彩种列表
- 支持按分类筛选查看
- 显示彩种基本信息：ID、名称、标识、简介等
- 显示彩种状态：启用/禁用、正常/维护中
- 支持排序功能
- 支持批量操作

### 3. 添加/编辑彩种

#### 基本信息
- **彩票分类**：选择彩种所属分类
- **彩种名称**：如"河北快3"
- **彩种标识**：唯一标识符，如"hebk3"（添加后不可修改）
- **停止投注间隔**：封盘前的时间，如"60秒"
- **期数**：每天的期数
- **彩种简介**：简单描述
- **彩票类型**：系统彩票或第三方平台

#### 系统彩票特殊设置
当选择"系统彩票"时，需额外设置：
- **关盘开始时间**：如 00:00:00
- **关盘结束时间**：如 23:59:59
- **开奖时间间隔**：1分钟、1.5分钟、2分钟、2.5分钟、3分钟、5分钟、10分钟

### 4. 状态管理
- **启用/禁用**：控制彩种是否在前台显示
- **正常/维护**：临时维护状态，用户看到维护提示

### 5. 排序功能
- 支持自定义排序
- 排序值越小越靠前
- 保存后立即生效

## API 接口

### 获取彩种列表
```
GET /api/admin/lottery/types
参数：typeid（可选，按分类筛选）
```

### 添加彩种
```
POST /api/admin/lottery/type/add
参数：{
  typeid, title, name, ftime, qishu, ftitle, issys,
  closetime1, closetime2, expecttime, listorder
}
```

### 更新彩种
```
PUT /api/admin/lottery/type/update
参数：{ id, typeid, title, ftime, qishu, ftitle, issys, ... }
```

### 删除彩种
```
DELETE /api/admin/lottery/type/delete
参数：{ id }
```

### 切换状态
```
POST /api/admin/lottery/toggle-status
参数：{ id, field } // field: isopen 或 iswh
```

### 保存排序
```
POST /api/admin/lottery/save-order
参数：{ orders: { id1: order1, id2: order2, ... } }
```

## 数据库表结构

### caipiao_caipiao 表
```sql
id          - 彩种ID
typeid      - 彩种分类 (ssc/k3/x5/...)
title       - 彩种名称
name        - 彩种标识（唯一）
ftime       - 停止投注间隔
qishu       - 每天期数
ftitle      - 彩种简介
issys       - 是否系统彩 (1:是 0:否)
isopen      - 是否启用 (1:启用 0:禁用)
iswh        - 是否维护 (1:维护 0:正常)
closetime1  - 关盘开始时间
closetime2  - 关盘结束时间
expecttime  - 开奖时间间隔（分钟）
listorder   - 排序（同分类内）
allsort     - 全局排序
```

## 使用说明

### 访问路径
```
http://localhost:5173/lottery-types
```

### 权限要求
- 需要管理员登录
- Token 必须包含 type='admin'

### 操作流程

1. **查看彩种列表**
   - 点击顶部分类标签可切换查看
   - "全部"显示所有彩种

2. **添加新彩种**
   - 点击"添加彩票"按钮
   - 填写必填信息（带*号）
   - 选择彩票类型
   - 如果是系统彩票，设置时间参数
   - 点击确定提交

3. **编辑彩种**
   - 点击彩种名称或编辑按钮
   - 修改信息
   - 注意：彩种标识不可修改
   - 点击确定保存

4. **切换状态**
   - 直接点击状态标签即可切换
   - 绿色=正常/启用，灰色=维护/禁用

5. **删除彩种**
   - 点击删除按钮
   - 确认删除操作
   - 注意：删除后数据无法恢复

6. **调整排序**
   - 修改"排序"列的数字
   - 点击"保存排序"按钮
   - 排序立即生效

## 注意事项

1. **彩种标识唯一性**
   - 添加时必须确保标识唯一
   - 标识用于程序内部识别，不可重复

2. **系统彩票设置**
   - 开奖时间间隔必须从预设值中选择
   - 关盘时间应合理设置

3. **删除警告**
   - 删除彩种前请确认该彩种已无相关数据
   - 建议先禁用而不是直接删除

4. **状态管理**
   - 维护状态：用于临时关闭，用户看到维护提示
   - 禁用状态：彩种不在前台显示

## 与老项目的对应关系

### 后端控制器
```
老项目: admin/app/Admincenter/Controller/CaipiaoController.class.php
新项目: server/public/api/admin/lottery_*.php
```

### 前端页面
```
老项目: admin/Template/admin/Caipiao_cptype.php
新项目: vue/admin/src/views/lottery/LotteryTypes.vue
```

### 功能对比
| 功能 | 老项目 | 新项目 | 状态 |
|------|--------|--------|------|
| 彩种列表 | ✅ | ✅ | 完全一致 |
| 按分类筛选 | ✅ | ✅ | 完全一致 |
| 添加彩种 | ✅ | ✅ | 完全一致 |
| 编辑彩种 | ✅ | ✅ | 完全一致 |
| 删除彩种 | ✅ | ✅ | 完全一致 |
| 切换状态 | ✅ | ✅ | 完全一致 |
| 排序功能 | ✅ | ✅ | 完全一致 |
| 系统彩设置 | ✅ | ✅ | 完全一致 |

## 测试步骤

1. ✅ 登录管理后台
2. ✅ 访问彩种管理页面
3. ✅ 查看彩种列表
4. ✅ 测试分类筛选
5. ✅ 测试添加彩种
6. ✅ 测试编辑彩种
7. ✅ 测试状态切换
8. ✅ 测试排序功能
9. ✅ 测试删除彩种

---

**功能已完成！** 🎉
彩种管理模块已完全实现，功能和样式与老项目保持一致。

