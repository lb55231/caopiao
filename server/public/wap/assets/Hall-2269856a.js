import{_ as R,u as $,r as h,p as B,o as H,a as I,b as u,c,d as i,e as s,w as N,f as d,j as T,F as C,h as S,s as P,t as v,n as V,k as M,g as L}from"./index-755e54f6.js";import{c as z,d as D,e as E}from"./lottery-115786bf.js";import{T as F}from"./Tabbar-7bdceb30.js";const G={name:"Hall",components:{Tabbar:F},setup(){const k=$(),a=h("k3"),p=h(!1),n=h([]),b=B(()=>n.value.filter(t=>t.typeid===a.value)),w=t=>{a.value=t};let l=null;const r=t=>{k.push(`/game/${t.name}`)},m=async()=>{p.value=!0;try{const t=await z();t.code===200&&(n.value=t.data.map(e=>({id:e.id,name:e.type_code,typeid:f(e.type_code),title:e.type_name,logo:e.icon||`/app/${e.type_code}.png`,lastResult:"",currentPeriod:"",countdown:"",countdownSeconds:0})),await y(),g())}catch(t){console.error("加载失败:",t),P("加载失败")}finally{p.value=!1}},f=t=>t.includes("k3")?"k3":t.includes("ssc")?"ssc":t.includes("pk10")?"pk10":t.includes("11x5")?"x5":t.includes("keno")?"keno":t.includes("lhc")?"lhc":"dpc",y=async()=>{for(let t of n.value)try{const e=await D(t.name);e.code===200&&(t.currentPeriod=e.data.period,t.countdownSeconds=e.data.countdown);const _=await E(t.name,1);_.code===200&&_.data.length>0&&(t.lastResult=_.data[0].open_code)}catch(e){console.error(`加载${t.title}详情失败:`,e)}},g=()=>{l&&clearInterval(l),l=setInterval(()=>{n.value.forEach(t=>{t.countdownSeconds>0?(t.countdownSeconds--,t.countdown=o(t.countdownSeconds)):t.countdown="00:00:00"})},1e3)},o=t=>{const e=Math.floor(t/3600),_=Math.floor(t%3600/60),x=t%60;return`${String(e).padStart(2,"0")}:${String(_).padStart(2,"0")}:${String(x).padStart(2,"0")}`};return H(()=>{m()}),I(()=>{l&&clearInterval(l)}),{activeTab:a,loading:p,currentList:b,onTabChange:w,goToGame:r}}},U={class:"hall-page"},j={class:"lottery-list"},q={key:1,class:"list-wrapper"},A=["onClick"],J=["src"],K={class:"lottery-info"},O={class:"lottery-title"},Q={key:0,class:"prize-num"},W={class:"lottery-period"},X={class:"timer"};function Y(k,a,p,n,b,w){const l=u("van-nav-bar"),r=u("van-tab"),m=u("van-tabs"),f=u("van-loading"),y=u("van-empty"),g=u("Tabbar");return c(),i("div",U,[s(l,{title:"下单大厅",fixed:""}),s(m,{active:n.activeTab,"onUpdate:active":a[0]||(a[0]=o=>n.activeTab=o),onChange:n.onTabChange,class:"hall-tabs"},{default:N(()=>[s(r,{title:"快3",name:"k3"}),s(r,{title:"时时彩",name:"ssc"}),s(r,{title:"pk10",name:"pk10"}),s(r,{title:"低频彩",name:"dpc"}),s(r,{title:"11选5",name:"x5"}),s(r,{title:"快乐彩",name:"keno"}),s(r,{title:"六合彩",name:"lhc"})]),_:1},8,["active","onChange"]),d("div",j,[n.loading?(c(),T(f,{key:0,class:"loading"})):n.currentList.length?(c(),i("div",q,[(c(!0),i(C,null,S(n.currentList,o=>(c(),i("div",{key:o.id,class:"lottery-item",onClick:t=>n.goToGame(o)},[d("img",{src:o.logo,class:"lottery-icon"},null,8,J),d("div",K,[d("h3",O,v(o.title),1),o.lastResult?(c(),i("div",Q,[(c(!0),i(C,null,S(o.lastResult.split(","),(t,e)=>(c(),i("span",{key:e,class:V(["num-ball",`ball-${t}`])},v(t),3))),128))])):M("",!0),d("p",W,[a[1]||(a[1]=L(" 第",-1)),d("span",null,v(o.currentPeriod),1),a[2]||(a[2]=L("期 截至",-1)),d("span",X,v(o.countdown),1)])])],8,A))),128))])):(c(),T(y,{key:2,description:"暂无数据"}))]),s(g)])}const nt=R(G,[["render",Y],["__scopeId","data-v-419cc884"]]);export{nt as default};
